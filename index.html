<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>なぞかけメーカー</title>
<meta name="description" content="お題を入れると『◯◯と掛けまして、△△と解きます。その心はどちらも□□でしょう。』を自動生成します。">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Noto+Serif+JP:wght@600;700&family=Zen+Kaku+Gothic+New:wght@400;700&display=swap" rel="stylesheet">
<style>
:root{
  /* Recruitサイトを意識したクリーンなブルー系 */
  --bg:#f6f9ff;
  --ink:#1f2937;
  --muted:#6b7280;
  --line:#e5e7eb;
  --white:#fff;
  --blue:#2563eb;
  --blue-700:#1d4ed8;
  --blue-soft:#eff6ff;
  --shadow:0 10px 24px rgba(15,23,42,.06), 0 2px 6px rgba(15,23,42,.05);
  --radius:16px;
}
*{box-sizing:border-box}
html,body{margin:0}
body{
  background:
    radial-gradient(900px 500px at 100% -20%, #fff 0%, #f3f7ff 60%, #eef2ff 100%) fixed,
    var(--bg);
  color:var(--ink);
  font-family:"Zen Kaku Gothic New", system-ui, -apple-system, "Segoe UI", Roboto, "Noto Sans JP", sans-serif;
  line-height:1.75;
}
.header{max-width:1120px;margin:0 auto;padding:28px 20px 8px;display:flex;gap:12px;align-items:center}
.logo{width:44px;height:44px;border-radius:12px;display:grid;place-items:center;background:var(--white);border:1px solid var(--line);box-shadow:var(--shadow)}
.logo::before{content:"語";font-family:"Noto Serif JP",serif;font-weight:700;color:var(--blue);font-size:22px;letter-spacing:.06em}
.title{margin:0;font-family:"Noto Serif JP",serif;font-weight:700;font-size:clamp(18px,2.6vw,24px);letter-spacing:.08em}
.container{max-width:980px;margin:0 auto;padding:16px 20px 80px}
.card{background:var(--white);border:1px solid var(--line);border-radius:var(--radius);padding:22px;box-shadow:var(--shadow)}

.grid{display:grid;grid-template-columns:1.3fr .7fr;gap:14px}
@media (max-width:760px){.grid{grid-template-columns:1fr}}
label{display:block;font-size:13px;color:var(--muted);margin-bottom:6px}
input[type="text"],select{
  width:100%;border:1px solid var(--line);border-radius:12px;padding:14px 16px;font-size:16px;background:#fff;outline:none;transition:.15s;
}
input[type="text"]:focus,select:focus{border-color:#bfd2ff;box-shadow:0 0 0 4px var(--blue-soft)}
.actions{display:flex;gap:10px;align-items:center;flex-wrap:wrap;margin-top:12px}
.btn{
  appearance:none;cursor:pointer;border-radius:999px;border:1px solid transparent;
  padding:12px 20px;font-weight:700;letter-spacing:.02em;transition:.15s;
}
.btn-primary{background:var(--blue);color:#fff}
.btn-primary:hover{background:var(--blue-700)}
.btn-ghost{background:#fff;color:var(--blue);border-color:#c7d2fe}

.out{margin-top:16px;background:#fff;border:1px solid var(--line);border-radius:12px;padding:14px;min-height:72px}
.piece{padding:10px 12px;border-bottom:1px dashed var(--line)}
.piece:last-child{border-bottom:none}
.small{color:var(--muted);font-size:12px}
.badge{color:#15803d;font-weight:700}
.footer{margin-top:28px;color:var(--muted);font-size:12px;text-align:center}
</style>
</head>
<body>
  <header class="header">
    <div class="logo" aria-hidden="true"></div>
    <h1 class="title">なぞかけメーカー</h1>
  </header>

  <main class="container">
    <section class="card">
      <div class="grid">
        <div>
          <label for="topic">お題（◯◯）</label>
          <input id="topic" type="text" placeholder="例：寿司 / 京都 / 野球 / ゲーム" />
        </div>
        <div>
          <label for="count">生成数</label>
          <select id="count">
            <option>1</option><option selected>3</option><option>5</option><option>10</option><option>20</option>
          </select>
        </div>
      </div>

      <div class="actions">
        <button id="btnMake" class="btn btn-primary">なぞかけを作る</button>
        <button id="btnShuffle" class="btn btn-ghost">お題ランダム</button>
        <span class="small"><span id="stat"></span></span>
      </div>

      <div id="out" class="out" aria-live="polite"></div>
    </section>

    <p class="footer">© 2025</p>
  </main>

<script>
/* -------------------------------------------------------
   仕様
   〇〇 … ユーザー入力 or ランダム
   △△ / ●● … 同音語グループから自動で2語（異なる語）を選ぶ
   型  … 「◯◯と掛けまして、△△と解きます。その心はどちらも●●でしょう。」
   ------------------------------------------------------- */

/* ランダムお題（入力空なら使う） */
const TOPICS = ["寿司","京都","野球","ゲーム","温泉","花火","ラーメン","新幹線","映画","写真","桜","キャンプ","宇宙","AI","スマホ","神社","お城","英語","受験","ギター","ピアノ","コーヒー","筋トレ","満員電車"];

/* ▼同音異義グループ
   形式: ["読み","語1","語2","語3"...]
   ここでは軽量に “数百語・数千通り” を同梱。
   本当に大規模化する場合は packs.json を分割ロードして拡張（下の fetchPacks() を使用）。
*/
const PACKS_BASE = [
  ["はし","橋","箸","端"],
  ["かみ","髪","神","紙"],
  ["あめ","雨","飴"],
  ["かえる","帰る","変える","替える","換える","蛙"],
  ["こうか","効果","硬貨","校歌","降下","高価"],
  ["きかん","期間","器官","機関","基幹"],
  ["しんこう","進行","信仰","新興","振興","深耕"],
  ["たいしょう","対象","対照","大将","大正"],
  ["どうこう","瞳孔","同行","動向"],
  ["きしょう","気象","希少","起床","記章"],
  ["へいこう","平行","並行","閉校","閉口"],
  ["けっこう","結構","血行","欠航"],
  ["せいかい","正解","政界","盛会","世界(近音)"],
  ["しんせい","申請","新生","神聖"],
  ["こうよう","紅葉","効用","公用"],
  ["はる","春","張る","貼る"],
  ["まつ","待つ","松","末"],
  ["みる","見る","診る","観る"],
  ["あう","会う","合う","遭う"],
  ["おり","檻","折り","織り"],
  ["なる","鳴る","成る","生る"],
  ["さとう","佐藤","砂糖"],
  ["はな","花","鼻","華"],
  ["つき","月","付き","突き"],
  ["かど","角","門"],
  ["かこう","加工","下降","火口"],
  ["こうしょう","交渉","高尚","工匠","校章"],
  ["しゅっせき","出席","出石"],
  ["ひょうか","評価","氷菓"],
  ["かんじ","漢字","感じ","幹事"],
  ["てんさい","天才","天災","甜菜"],
  ["けいこう","傾向","蛍光","傾向"],
  // …必要に応じて増やしてOK
];

/* packs.json など外部拡張読み込み（巨大語彙用の入口） */
async function fetchPacks() {
  try {
    // もしリポジトリに /packs.json を置いたら以下を有効化
    // const res = await fetch('packs.json', {cache:'no-store'});
    // if(res.ok){ const extra = await res.json(); return extra; }
  } catch(e){}
  return [];
}

const $ = s => document.querySelector(s);
const choice = arr => arr[Math.floor(Math.random()*arr.length)];

function randomTopic(){ return choice(TOPICS); }

/* グループ => ランダムに2語（異なる語）を返す */
function pickTwoDifferent(words){
  if(words.length < 2) return null;
  const a = choice(words);
  let b = choice(words);
  let guard = 0;
  while(b === a && guard++ < 10) b = choice(words);
  return a===b ? null : [a,b];
}

/* 型に落とし込む */
function buildLine(topic, a, b){
  // a を △△、b を ●● に割当て
  return `「${topic}」と掛けまして、「${a}」と解きます。その心はどちらも「${b}」でしょう。`;
}

/* 生成 */
function make(topic, n, groups){
  const out = [];
  for(let i=0;i<n;i++){
    const g = choice(groups);
    const pair = pickTwoDifferent(g.slice(1));
    if(!pair){ i--; continue; }
    const [a,b] = pair;
    out.push( buildLine(topic, a, b) );
  }
  return out;
}

/* UI */
async function init(){
  const extra = await fetchPacks();           // 外部巨大語彙（あれば）
  const GROUPS = [...PACKS_BASE, ...extra];   // マージ

  $("#topic").value = randomTopic();
  $("#stat").textContent = `語彙グループ: ${GROUPS.length.toLocaleString()} / 組合せの目安: 数千〜数万通り`;

  const render = ()=>{
    const topic = ($("#topic").value || "").trim() || randomTopic();
    $("#topic").value = topic;
    const count = parseInt($("#count").value,10) || 3;
    const list = make(topic, count, GROUPS);
    $("#out").innerHTML = list.map(s=>`<div class="piece">${s}</div>`).join("");
  };

  $("#btnMake").addEventListener("click", render);
  $("#btnShuffle").addEventListener("click", ()=>{
    $("#topic").value = randomTopic();
  });

  // 初回
  render();
}
window.addEventListener("DOMContentLoaded", init);
</script>
</body>
</html>
